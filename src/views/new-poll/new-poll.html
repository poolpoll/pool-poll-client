<dom-module id="new-poll">
	<template>
		<neon-animated-pages attr-for-selected="step" selected="[[step]]">
			<neon-animatable entry-animation="slide-from-left-animation" exit-animation="slide-left-animation" step="basic">
				<new-poll-basic
					id="basic" 
					step="{{step}}">
				</new-poll-basic>
			</neon-animatable>
			
			<neon-animatable entry-animation="slide-from-right-animation" exit-animation="slide-right-animation" step="detail">
				<new-poll-detail
					id="detail"
					step="{{step}}"
					basic-info="[[basicInfo]]">
				</new-poll-detail>
			</neon-animatable>
		</neon-animated-pages>
	</template>
	<script>
		Polymer({
			is: 'new-poll',

			properties: {

				name: {
					type: String,
					notify: true
				},

				description: {
					type: String,
					notify: true
				},

				categoryId: {
					type: Number,
					notify: true
				},

				fromDate: {
					type: String,
					notify: true
				},

				toDate: {
					type: String,
					notify: true
				},

				step: {
					type: String,
					value: 'basic'
				}
			},

			ready: function() {
				document.addEventListener('new-poll-registed', function() {
					this.$['basic'].clearValue();
					this.$['detail'].clearValue();
					this.moveToDetail();
				}.bind(this))

				document.addEventListener('swipe-to-right', function() {
					if(this.step == 'detail') {
						this.moveToBasic();
					}
				}.bind(this));

				document.addEventListener('swipe-to-left', function() {
					if(this.step == 'basic') {
						this.moveToDetail();
					}
				}.bind(this));
			},

			moveToBasic: function() {
				this.step = 'basic';
			},

			moveToDetail: function() {
				if(this.$['basic'].validate()) {
					this.basicInfo = this.$['basic'].getBasicInfo();
					this.step = 'detail';
				}
			}
		})
	</script>
</dom-module>